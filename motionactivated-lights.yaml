blueprint:
  name: 'âœ¨ Advanced Multi-Room Motion Lighting'
  description: >
    Control multiple rooms (up to 5) independently using motion sensors, lux levels, 
    and time-of-day modes. Prevents lights from turning on if the room is already bright enough.
  domain: automation
  input:
    # ===================================================================================
    # GLOBAL SETTINGS
    # ===================================================================================
    lux_entity:
      name: Global Ambient Light Sensor (Lux)
      description: The sensor entity providing the current ambient light level (in lux).
      selector:
        entity:
          domain: sensor
          device_class: illuminance
    
    # ===================================================================================
    # TIME OF DAY DEFINITION
    # ===================================================================================
    time_morning_start:
      name: ðŸŒ… Morning Start Time
      description: Lights will use 'Morning' settings after this time. (e.g., 06:00:00)
      default: '06:00:00'
      selector:
        time:
      
    time_day_start:
      name: â˜€ï¸ Daytime Start Time
      description: Lights will use 'Daytime' settings after this time. (e.g., 08:00:00)
      default: '08:00:00'
      selector:
        time:
      
    time_night_start:
      name: ðŸŒ™ Night Start Time
      description: Lights will use 'Night' settings after this time. (e.g., 22:00:00)
      default: '22:00:00'
      selector:
        time:

    # ===================================================================================
    # ROOM 1 CONFIGURATION
    # ===================================================================================
    room_1_name:
      name: 1. Room Name (e.g., Hallway)
      default: 'Room 1'
      selector:
        text:
    
    room_1_enabled:
      name: Enable Room 1 Automation
      default: true
      selector:
        boolean:
      
    room_1_motion_sensor:
      name: Motion/Occupancy Sensor
      description: Select the sensor that triggers the light(s).
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
      
    room_1_lights:
      name: Target Light(s)
      description: Select one or more light entities to control.
      selector:
        target:
          entity:
            domain: light
      
    room_1_off_delay:
      name: â±ï¸ Lights Off Delay (seconds)
      description: The time after the last motion detected before lights turn off.
      default: 180
      selector:
        number:
          min: 30
          max: 1800
          unit_of_measurement: seconds
      
    room_1_override_switch:
      name: ðŸ›‘ Manual Override Switch (Optional)
      description: If this helper switch is ON, the automation will be disabled for this room.
      default: ''
      selector:
        entity:
          domain: input_boolean
          multiple: false
          
    room_1_lux_threshold:
      name: ðŸ’¡ Lux Threshold (Lights-On Limit)
      description: If the ambient lux is ABOVE this value, the lights will NOT turn on. (e.g., 50 lux)
      default: 50
      selector:
        number:
          min: 5
          max: 500
          unit_of_measurement: lux
      
    # Room 1 Brightness Settings (Collapsed by Default)
    room_1_morning_settings:
      name: ðŸŒ… Morning Light Settings (After {{ time_morning_start }} & Before {{ time_day_start }})
      description: Brightness and Color Temperature for morning hours.
      default: {}
      selector:
        object:
      
    room_1_morning_brightness:
      name: Morning Brightness (%)
      default: 50
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_1_morning_temp:
      name: Morning Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 4000K).
      default: 4000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_1_daytime_settings:
      name: â˜€ï¸ Daytime Light Settings (After {{ time_day_start }} & Before {{ time_night_start }})
      description: Brightness and Color Temperature for general daytime hours.
      default: {}
      selector:
        object:
      
    room_1_daytime_brightness:
      name: Daytime Brightness (%)
      default: 80
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_1_daytime_temp:
      name: Daytime Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 5500K).
      default: 5500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_1_night_settings:
      name: ðŸŒ™ Night Light Settings (After {{ time_night_start }} & Before {{ time_morning_start }})
      description: Low brightness and warm color for late night/sleep hours.
      default: {}
      selector:
        object:
      
    room_1_night_brightness:
      name: Night Brightness (%)
      default: 20
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_1_night_temp:
      name: Night Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 2700K).
      default: 2700
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K

    # ===================================================================================
    # ROOM 2 CONFIGURATION
    # ===================================================================================
    room_2_name:
      name: 2. Room Name (e.g., Kitchen)
      default: 'Room 2'
      selector:
        text:
    
    room_2_enabled:
      name: Enable Room 2 Automation
      default: false
      selector:
        boolean:
      
    room_2_motion_sensor:
      name: Motion/Occupancy Sensor
      description: Select the sensor that triggers the light(s).
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
      
    room_2_lights:
      name: Target Light(s)
      description: Select one or more light entities to control.
      selector:
        target:
          entity:
            domain: light
      
    room_2_off_delay:
      name: â±ï¸ Lights Off Delay (seconds)
      description: The time after the last motion detected before lights turn off.
      default: 180
      selector:
        number:
          min: 30
          max: 1800
          unit_of_measurement: seconds
      
    room_2_override_switch:
      name: ðŸ›‘ Manual Override Switch (Optional)
      description: If this helper switch is ON, the automation will be disabled for this room.
      default: ''
      selector:
        entity:
          domain: input_boolean
          multiple: false
          
    room_2_lux_threshold:
      name: ðŸ’¡ Lux Threshold (Lights-On Limit)
      description: If the ambient lux is ABOVE this value, the lights will NOT turn on. (e.g., 50 lux)
      default: 50
      selector:
        number:
          min: 5
          max: 500
          unit_of_measurement: lux
      
    # Room 2 Brightness Settings (Collapsed by Default)
    room_2_morning_settings:
      name: ðŸŒ… Morning Light Settings (After {{ time_morning_start }} & Before {{ time_day_start }})
      description: Brightness and Color Temperature for morning hours.
      default: {}
      selector:
        object:
      
    room_2_morning_brightness:
      name: Morning Brightness (%)
      default: 60
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_2_morning_temp:
      name: Morning Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 4000K).
      default: 4000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_2_daytime_settings:
      name: â˜€ï¸ Daytime Light Settings (After {{ time_day_start }} & Before {{ time_night_start }})
      description: Brightness and Color Temperature for general daytime hours.
      default: {}
      selector:
        object:
      
    room_2_daytime_brightness:
      name: Daytime Brightness (%)
      default: 90
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_2_daytime_temp:
      name: Daytime Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 5500K).
      default: 5500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_2_night_settings:
      name: ðŸŒ™ Night Light Settings (After {{ time_night_start }} & Before {{ time_morning_start }})
      description: Low brightness and warm color for late night/sleep hours.
      default: {}
      selector:
        object:
      
    room_2_night_brightness:
      name: Night Brightness (%)
      default: 25
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_2_night_temp:
      name: Night Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 2700K).
      default: 2700
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    # ===================================================================================
    # ROOM 3 CONFIGURATION
    # ===================================================================================
    room_3_name:
      name: 3. Room Name (e.g., Office)
      default: 'Room 3'
      selector:
        text:
    
    room_3_enabled:
      name: Enable Room 3 Automation
      default: false
      selector:
        boolean:
      
    room_3_motion_sensor:
      name: Motion/Occupancy Sensor
      description: Select the sensor that triggers the light(s).
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
      
    room_3_lights:
      name: Target Light(s)
      description: Select one or more light entities to control.
      selector:
        target:
          entity:
            domain: light
      
    room_3_off_delay:
      name: â±ï¸ Lights Off Delay (seconds)
      description: The time after the last motion detected before lights turn off.
      default: 300
      selector:
        number:
          min: 30
          max: 1800
          unit_of_measurement: seconds
      
    room_3_override_switch:
      name: ðŸ›‘ Manual Override Switch (Optional)
      description: If this helper switch is ON, the automation will be disabled for this room.
      default: ''
      selector:
        entity:
          domain: input_boolean
          multiple: false
          
    room_3_lux_threshold:
      name: ðŸ’¡ Lux Threshold (Lights-On Limit)
      description: If the ambient lux is ABOVE this value, the lights will NOT turn on. (e.g., 50 lux)
      default: 70
      selector:
        number:
          min: 5
          max: 500
          unit_of_measurement: lux
      
    # Room 3 Brightness Settings (Collapsed by Default)
    room_3_morning_settings:
      name: ðŸŒ… Morning Light Settings (After {{ time_morning_start }} & Before {{ time_day_start }})
      description: Brightness and Color Temperature for morning hours.
      default: {}
      selector:
        object:
      
    room_3_morning_brightness:
      name: Morning Brightness (%)
      default: 50
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_3_morning_temp:
      name: Morning Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 4000K).
      default: 4500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_3_daytime_settings:
      name: â˜€ï¸ Daytime Light Settings (After {{ time_day_start }} & Before {{ time_night_start }})
      description: Brightness and Color Temperature for general daytime hours.
      default: {}
      selector:
        object:
      
    room_3_daytime_brightness:
      name: Daytime Brightness (%)
      default: 100
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_3_daytime_temp:
      name: Daytime Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 5500K).
      default: 6000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_3_night_settings:
      name: ðŸŒ™ Night Light Settings (After {{ time_night_start }} & Before {{ time_morning_start }})
      description: Low brightness and warm color for late night/sleep hours.
      default: {}
      selector:
        object:
      
    room_3_night_brightness:
      name: Night Brightness (%)
      default: 30
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_3_night_temp:
      name: Night Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 2700K).
      default: 3000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K

    # ===================================================================================
    # ROOM 4 CONFIGURATION
    # ===================================================================================
    room_4_name:
      name: 4. Room Name (e.g., Bedroom)
      default: 'Room 4'
      selector:
        text:
    
    room_4_enabled:
      name: Enable Room 4 Automation
      default: false
      selector:
        boolean:
      
    room_4_motion_sensor:
      name: Motion/Occupancy Sensor
      description: Select the sensor that triggers the light(s).
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
      
    room_4_lights:
      name: Target Light(s)
      description: Select one or more light entities to control.
      selector:
        target:
          entity:
            domain: light
      
    room_4_off_delay:
      name: â±ï¸ Lights Off Delay (seconds)
      description: The time after the last motion detected before lights turn off.
      default: 120
      selector:
        number:
          min: 30
          max: 1800
          unit_of_measurement: seconds
      
    room_4_override_switch:
      name: ðŸ›‘ Manual Override Switch (Optional)
      description: If this helper switch is ON, the automation will be disabled for this room.
      default: ''
      selector:
        entity:
          domain: input_boolean
          multiple: false
          
    room_4_lux_threshold:
      name: ðŸ’¡ Lux Threshold (Lights-On Limit)
      description: If the ambient lux is ABOVE this value, the lights will NOT turn on. (e.g., 50 lux)
      default: 40
      selector:
        number:
          min: 5
          max: 500
          unit_of_measurement: lux
      
    # Room 4 Brightness Settings (Collapsed by Default)
    room_4_morning_settings:
      name: ðŸŒ… Morning Light Settings (After {{ time_morning_start }} & Before {{ time_day_start }})
      description: Brightness and Color Temperature for morning hours.
      default: {}
      selector:
        object:
      
    room_4_morning_brightness:
      name: Morning Brightness (%)
      default: 40
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_4_morning_temp:
      name: Morning Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 4000K).
      default: 3500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_4_daytime_settings:
      name: â˜€ï¸ Daytime Light Settings (After {{ time_day_start }} & Before {{ time_night_start }})
      description: Brightness and Color Temperature for general daytime hours.
      default: {}
      selector:
        object:
      
    room_4_daytime_brightness:
      name: Daytime Brightness (%)
      default: 60
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_4_daytime_temp:
      name: Daytime Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 5500K).
      default: 5000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_4_night_settings:
      name: ðŸŒ™ Night Light Settings (After {{ time_night_start }} & Before {{ time_morning_start }})
      description: Low brightness and warm color for late night/sleep hours.
      default: {}
      selector:
        object:
      
    room_4_night_brightness:
      name: Night Brightness (%)
      default: 10
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_4_night_temp:
      name: Night Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 2700K).
      default: 2500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K

    # ===================================================================================
    # ROOM 5 CONFIGURATION
    # ===================================================================================
    room_5_name:
      name: 5. Room Name (e.g., Bathroom)
      default: 'Room 5'
      selector:
        text:
    
    room_5_enabled:
      name: Enable Room 5 Automation
      default: false
      selector:
        boolean:
      
    room_5_motion_sensor:
      name: Motion/Occupancy Sensor
      description: Select the sensor that triggers the light(s).
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
      
    room_5_lights:
      name: Target Light(s)
      description: Select one or more light entities to control.
      selector:
        target:
          entity:
            domain: light
      
    room_5_off_delay:
      name: â±ï¸ Lights Off Delay (seconds)
      description: The time after the last motion detected before lights turn off.
      default: 60
      selector:
        number:
          min: 30
          max: 1800
          unit_of_measurement: seconds
      
    room_5_override_switch:
      name: ðŸ›‘ Manual Override Switch (Optional)
      description: If this helper switch is ON, the automation will be disabled for this room.
      default: ''
      selector:
        entity:
          domain: input_boolean
          multiple: false
          
    room_5_lux_threshold:
      name: ðŸ’¡ Lux Threshold (Lights-On Limit)
      description: If the ambient lux is ABOVE this value, the lights will NOT turn on. (e.g., 50 lux)
      default: 50
      selector:
        number:
          min: 5
          max: 500
          unit_of_measurement: lux
      
    # Room 5 Brightness Settings (Collapsed by Default)
    room_5_morning_settings:
      name: ðŸŒ… Morning Light Settings (After {{ time_morning_start }} & Before {{ time_day_start }})
      description: Brightness and Color Temperature for morning hours.
      default: {}
      selector:
        object:
      
    room_5_morning_brightness:
      name: Morning Brightness (%)
      default: 50
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_5_morning_temp:
      name: Morning Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 4000K).
      default: 4000
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_5_daytime_settings:
      name: â˜€ï¸ Daytime Light Settings (After {{ time_day_start }} & Before {{ time_night_start }})
      description: Brightness and Color Temperature for general daytime hours.
      default: {}
      selector:
        object:
      
    room_5_daytime_brightness:
      name: Daytime Brightness (%)
      default: 80
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_5_daytime_temp:
      name: Daytime Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 5500K).
      default: 5500
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K
      
    room_5_night_settings:
      name: ðŸŒ™ Night Light Settings (After {{ time_night_start }} & Before {{ time_morning_start }})
      description: Low brightness and warm color for late night/sleep hours.
      default: {}
      selector:
        object:
      
    room_5_night_brightness:
      name: Night Brightness (%)
      default: 15
      selector:
        number:
          min: 1
          max: 100
          mode: slider
      
    room_5_night_temp:
      name: Night Color Temperature (Kelvin)
      description: Color temperature in Kelvin (e.g., 2700K).
      default: 2700
      selector:
        number:
          min: 1500
          max: 6500
          mode: slider
          unit_of_measurement: K

variables:
  # Get the current time as a seconds-since-midnight number for comparison
  current_time_seconds: "{{ now().hour * 3600 + now().minute * 60 + now().second }}"
  
  # Convert user-defined time inputs (which are strings "HH:MM:SS" from the selector) to seconds since midnight
  # Note: The input keys (time_morning_start, etc.) are available as variables in the template.
  morning_start_seconds: "{{ (time_morning_start | default('06:00:00', true)).split(':')[0] | int * 3600 + (time_morning_start | default('06:00:00', true)).split(':')[1] | int * 60 }}"
  day_start_seconds: "{{ (time_day_start | default('08:00:00', true)).split(':')[0] | int * 3600 + (time_day_start | default('08:00:00', true)).split(':')[1] | int * 60 }}"
  night_start_seconds: "{{ (time_night_start | default('22:00:00', true)).split(':')[0] | int * 3600 + (time_night_start | default('22:00:00', true)).split(':')[1] | int * 60 }}"
  
  # Determine the current time-of-day mode
  time_mode: >
    {% if current_time_seconds >= night_start_seconds %}
      night
    {% elif current_time_seconds >= day_start_seconds %}
      daytime
    {% elif current_time_seconds >= morning_start_seconds %}
      morning
    {% else %}
      night
    {% endif %}

  # --- ROOM 1 Dynamic Settings ---
  room_1_brightness: >
    {% if time_mode == 'morning' %}
      {{ (room_1_morning_brightness | float * 2.55) | int }}
    {% elif time_mode == 'daytime' %}
      {{ (room_1_daytime_brightness | float * 2.55) | int }}
    {% else %}
      {{ (room_1_night_brightness | float * 2.55) | int }}
    {% endif %}
  room_1_color_temp: >
    {% if time_mode == 'morning' %}
      {{ room_1_morning_temp | int }}
    {% elif time_mode == 'daytime' %}
      {{ room_1_daytime_temp | int }}
    {% else %}
      {{ room_1_night_temp | int }}
    {% endif %}

  # --- ROOM 2 Dynamic Settings ---
  room_2_brightness: >
    {% if time_mode == 'morning' %}
      {{ (room_2_morning_brightness | float * 2.55) | int }}
    {% elif time_mode == 'daytime' %}
      {{ (room_2_daytime_brightness | float * 2.55) | int }}
    {% else %}
      {{ (room_2_night_brightness | float * 2.55) | int }}
    {% endif %}
  room_2_color_temp: >
    {% if time_mode == 'morning' %}
      {{ room_2_morning_temp | int }}
    {% elif time_mode == 'daytime' %}
      {{ room_2_daytime_temp | int }}
    {% else %}
      {{ room_2_night_temp | int }}
    {% endif %}

  # --- ROOM 3 Dynamic Settings ---
  room_3_brightness: >
    {% if time_mode == 'morning' %}
      {{ (room_3_morning_brightness | float * 2.55) | int }}
    {% elif time_mode == 'daytime' %}
      {{ (room_3_daytime_brightness | float * 2.55) | int }}
    {% else %}
      {{ (room_3_night_brightness | float * 2.55) | int }}
    {% endif %}
  room_3_color_temp: >
    {% if time_mode == 'morning' %}
      {{ room_3_morning_temp | int }}
    {% elif time_mode == 'daytime' %}
      {{ room_3_daytime_temp | int }}
    {% else %}
      {{ room_3_night_temp | int }}
    {% endif %}

  # --- ROOM 4 Dynamic Settings ---
  room_4_brightness: >
    {% if time_mode == 'morning' %}
      {{ (room_4_morning_brightness | float * 2.55) | int }}
    {% elif time_mode == 'daytime' %}
      {{ (room_4_daytime_brightness | float * 2.55) | int }}
    {% else %}
      {{ (room_4_night_brightness | float * 2.55) | int }}
    {% endif %}
  room_4_color_temp: >
    {% if time_mode == 'morning' %}
      {{ room_4_morning_temp | int }}
    {% elif time_mode == 'daytime' %}
      {{ room_4_daytime_temp | int }}
    {% else %}
      {{ room_4_night_temp | int }}
    {% endif %}

  # --- ROOM 5 Dynamic Settings ---
  room_5_brightness: >
    {% if time_mode == 'morning' %}
      {{ (room_5_morning_brightness | float * 2.55) | int }}
    {% elif time_mode == 'daytime' %}
      {{ (room_5_daytime_brightness | float * 2.55) | int }}
    {% else %}
      {{ (room_5_night_brightness | float * 2.55) | int }}
    {% endif %}
  room_5_color_temp: >
    {% if time_mode == 'morning' %}
      {{ room_5_morning_temp | int }}
    {% elif time_mode == 'daytime' %}
      {{ room_5_daytime_temp | int }}
    {% else %}
      {{ room_5_night_temp | int }}
    {% endif %}
  
trigger:
  # Triggers for Room 1
  - platform: state
    entity_id: !input room_1_motion_sensor
    to: 'on'
    id: 'room_1_on'
    
  - platform: state
    entity_id: !input room_1_motion_sensor
    to: 'off'
    for: "{{ room_1_off_delay | int }}"
    id: 'room_1_off'

  # Triggers for Room 2
  - platform: state
    entity_id: !input room_2_motion_sensor
    to: 'on'
    id: 'room_2_on'
    
  - platform: state
    entity_id: !input room_2_motion_sensor
    to: 'off'
    for: "{{ room_2_off_delay | int }}"
    id: 'room_2_off'

  # Triggers for Room 3
  - platform: state
    entity_id: !input room_3_motion_sensor
    to: 'on'
    id: 'room_3_on'
    
  - platform: state
    entity_id: !input room_3_motion_sensor
    to: 'off'
    for: "{{ room_3_off_delay | int }}"
    id: 'room_3_off'
    
  # Triggers for Room 4
  - platform: state
    entity_id: !input room_4_motion_sensor
    to: 'on'
    id: 'room_4_on'
    
  - platform: state
    entity_id: !input room_4_motion_sensor
    to: 'off'
    for: "{{ room_4_off_delay | int }}"
    id: 'room_4_off'
    
  # Triggers for Room 5
  - platform: state
    entity_id: !input room_5_motion_sensor
    to: 'on'
    id: 'room_5_on'
    
  - platform: state
    entity_id: !input room_5_motion_sensor
    to: 'off'
    for: "{{ room_5_off_delay | int }}"
    id: 'room_5_off'

action:
  - choose:
      # ===================================================================================
      # LIGHTS ON/OFF LOGIC (ROOM 1)
      # ===================================================================================
      # Lights ON
    - conditions:
        - condition: trigger
          id: 'room_1_on'
        - condition: template
          value: "{{ room_1_enabled }}"
        # Override Check: Skip if manual override is active (if entity is provided)
        - condition: template
          value: "{{ not is_state(room_1_override_switch, 'on') if room_1_override_switch != '' else true }}"
        # Lux Check: Only turn on if current lux is below the room's threshold
        - condition: template
          value: "{{ states(lux_entity) | float(0) < room_1_lux_threshold | float(0) }}"
      sequence:
        - service: light.turn_on
          data:
            brightness: "{{ room_1_brightness }}"
            color_temp: "{{ room_1_color_temp }}"
            transition: 1
          target: !input room_1_lights

      # Lights OFF
    - conditions:
        - condition: trigger
          id: 'room_1_off'
      sequence:
        - service: light.turn_off
          data:
            transition: 2
          target: !input room_1_lights

      # ===================================================================================
      # LIGHTS ON/OFF LOGIC (ROOM 2)
      # ===================================================================================
      # Lights ON
    - conditions:
        - condition: trigger
          id: 'room_2_on'
        - condition: template
          value: "{{ room_2_enabled }}"
        # Override Check
        - condition: template
          value: "{{ not is_state(room_2_override_switch, 'on') if room_2_override_switch != '' else true }}"
        # Lux Check
        - condition: template
          value: "{{ states(lux_entity) | float(0) < room_2_lux_threshold | float(0) }}"
      sequence:
        - service: light.turn_on
          data:
            brightness: "{{ room_2_brightness }}"
            color_temp: "{{ room_2_color_temp }}"
            transition: 1
          target: !input room_2_lights

      # Lights OFF
    - conditions:
        - condition: trigger
          id: 'room_2_off'
      sequence:
        - service: light.turn_off
          data:
            transition: 2
          target: !input room_2_lights

      # ===================================================================================
      # LIGHTS ON/OFF LOGIC (ROOM 3)
      # ===================================================================================
      # Lights ON
    - conditions:
        - condition: trigger
          id: 'room_3_on'
        - condition: template
          value: "{{ room_3_enabled }}"
        # Override Check
        - condition: template
          value: "{{ not is_state(room_3_override_switch, 'on') if room_3_override_switch != '' else true }}"
        # Lux Check
        - condition: template
          value: "{{ states(lux_entity) | float(0) < room_3_lux_threshold | float(0) }}"
      sequence:
        - service: light.turn_on
          data:
            brightness: "{{ room_3_brightness }}"
            color_temp: "{{ room_3_color_temp }}"
            transition: 1
          target: !input room_3_lights

      # Lights OFF
    - conditions:
        - condition: trigger
          id: 'room_3_off'
      sequence:
        - service: light.turn_off
          data:
            transition: 2
          target: !input room_3_lights

      # ===================================================================================
      # LIGHTS ON/OFF LOGIC (ROOM 4)
      # ===================================================================================
      # Lights ON
    - conditions:
        - condition: trigger
          id: 'room_4_on'
        - condition: template
          value: "{{ room_4_enabled }}"
        # Override Check
        - condition: template
          value: "{{ not is_state(room_4_override_switch, 'on') if room_4_override_switch != '' else true }}"
        # Lux Check
        - condition: template
          value: "{{ states(lux_entity) | float(0) < room_4_lux_threshold | float(0) }}"
      sequence:
        - service: light.turn_on
          data:
            brightness: "{{ room_4_brightness }}"
            color_temp: "{{ room_4_color_temp }}"
            transition: 1
          target: !input room_4_lights

      # Lights OFF
    - conditions:
        - condition: trigger
          id: 'room_4_off'
      sequence:
        - service: light.turn_off
          data:
            transition: 2
          target: !input room_4_lights

      # ===================================================================================
      # LIGHTS ON/OFF LOGIC (ROOM 5)
      # ===================================================================================
      # Lights ON
    - conditions:
        - condition: trigger
          id: 'room_5_on'
        - condition: template
          value: "{{ room_5_enabled }}"
        # Override Check
        - condition: template
          value: "{{ not is_state(room_5_override_switch, 'on') if room_5_override_switch != '' else true }}"
        # Lux Check
        - condition: template
          value: "{{ states(lux_entity) | float(0) < room_5_lux_threshold | float(0) }}"
      sequence:
        - service: light.turn_on
          data:
            brightness: "{{ room_5_brightness }}"
            color_temp: "{{ room_5_color_temp }}"
            transition: 1
          target: !input room_5_lights

      # Lights OFF
    - conditions:
        - condition: trigger
          id: 'room_5_off'
      sequence:
        - service: light.turn_off
          data:
            transition: 2
          target: !input room_5_lights
mode: restart